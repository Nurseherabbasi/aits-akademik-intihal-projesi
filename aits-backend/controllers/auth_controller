from flask import jsonify
from models.user_model import users_db
from utils.jwt_helper import generate_token

def login_user(data):
    username = data.get("username")
    password = data.get("password")

    user = users_db.get(username)

    if user and user["password"] == password:
        token = generate_token({"username": username})
        return jsonify({"message": "Giriş başarılı", "token": token}), 200
    else:
        return jsonify({"message": "Kullanıcı adı veya şifre hatalı"}), 401
